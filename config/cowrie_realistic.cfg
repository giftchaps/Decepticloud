# Realistic Cowrie SSH Honeypot Configuration
# Hardened to avoid detection and maximize dwell time

[honeypot]
# Randomize hostname to match AWS naming (update per deployment)
hostname = ip-10-0-1-42

# CRITICAL: Use realistic SSH banner matching Ubuntu 22.04 on AWS
ssh_version_string = SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.6

# Listen port
listen_endpoints = tcp:2222:interface=0.0.0.0

# Authentication
auth_class = UserDB
auth_class_parameters = etc/userdb.txt

# Allow realistic authentication attempts before blocking
auth_none_enabled = false

# Simulate realistic delays (important for avoiding detection)
# Real systems have variable latency based on load
backend_ssh_exec_delay_min = 0.1
backend_ssh_exec_delay_max = 2.0

[ssh]
# Key generation algorithm
rsa_public_key = etc/ssh_host_rsa_key.pub
rsa_private_key = etc/ssh_host_rsa_key
dsa_public_key = etc/ssh_host_dsa_key.pub
dsa_private_key = etc/ssh_host_dsa_key

# Realistic cipher list (match real Ubuntu)
ciphers = aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com
macs = hmac-sha2-256,hmac-sha2-512,hmac-sha1
compression = none,zlib@openssh.com

# Realistic key exchange
kex = curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256

[shell]
# Use realistic filesystem (must be created separately)
filesystem = share/cowrie/fs-ubuntu22-aws.pickle

# Realistic processes
processes = share/cowrie/processes-aws.txt

# Kernel info matching AWS EC2 Ubuntu 22.04
kernel_version = 5.15.0-1052-aws
kernel_build_string = #57-Ubuntu SMP Tue Nov 14 10:54:31 UTC 2023
hardware_platform = x86_64
operating_system = GNU/Linux

# Hostname
hostname = ip-10-0-1-42

# Prompt (realistic AWS Ubuntu)
prompt = {username}@{hostname}:~$

# Enable interactive features
ssh_ident = SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.6
sftp_enabled = true

[shell:commands]
# Enable common commands
ls
cat
cd
pwd
uname
whoami
id
ps
netstat
ifconfig
wget
curl
apt
docker

[output_jsonlog]
# Log to JSON for analysis
logfile = var/log/cowrie/cowrie.json

[output_textlog]
# Also keep text logs
logfile = var/log/cowrie/cowrie.log

[output_syslog]
# Syslog output (optional)
enabled = false

# Telnet disabled (SSH only)
[telnet]
enabled = false

# Backend pool for command proxying (optional advanced feature)
[backend_pool]
# Set to true to proxy some commands to real VMs
pool_only = false
pool_max_vms = 0

# Network capabilities
[proxy]
enabled = false

# Download limits (prevent abuse)
[output_s3]
enabled = false

# Database logging (optional)
[output_mysql]
enabled = false

[output_sqlite]
# Local database for analytics
enabled = true
db_file = var/lib/cowrie/cowrie.db

# File upload/download
[output_localsyslog]
enabled = false
